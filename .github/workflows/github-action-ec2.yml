name: Push-to-EC2

# Trigger deployment only on push to main branch
on:
  push:
  branches:
    -main

job:
deploy:
name: Deploy to EC2 on master branch push
runs-on ubuntu-latest

step:
  -name:checkout the files
  user: action/checkout@v2

  -name:Deploy to server 1
   user:easingthemes/ssh-deploy@main
env:
SSH-PRIVATE_KEY: ${{ secrets.EC2_SSH_KEY }}
REMOTE_HOST: ${{ secrets.HOST_DNS }}
RENOTE_USER: ${{ secrets.USERNAME }}
TARGET: ${{ secrets.TARGET_DIR }}

-name:Executing remote ssh commands using ssh key
user:appleboy//ssh_action@master
with:
host: ${{secrets.HOST_DNS }}
username: ${{ secrets.USERNAME }}
key: ${{ secrets.EC2_SSH_KEY }}
scripts: |
sudo apt-get -y update
sudo apt-get install -y apache2
sudo systemctl start apache2
sudo systemctl enable apache2
cd home
sudo mv * var/www/html






